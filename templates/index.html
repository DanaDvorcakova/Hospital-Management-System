{% extends "base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<!-- Welcome Section -->
<h2 class="mb-4">Welcome, {{ session.role|capitalize }}</h2>

<!-- Today's Date Section -->
<div class="row mb-4">
    <div class="col-md-4">
        <div class="card date-card" style="background-color: #007bff; color: white;">
            <div class="card-body">
                <h5 class="card-title">Today's Date</h5>
                <p class="card-text fs-4">{{ today }}</p>
            </div>
        </div>
    </div>
</div>

<!-- Role-based Section for Navigation Links -->
<div class="row">
    {% if session.role == 'admin' %}

<!-- Admin Role: Doctors and Patients Management -->
<div class="col-md-4">
    <div class="doctors-card mb-3">
        <div class="card-body d-flex justify-content-between align-items-center">
            <div>
                <h5 class="card-title">Doctors</h5>
                <p class="card-text">Manage Doctors</p>
                <a href="{{ url_for('admin_doctors') }}" class="btn btn-primary">View Doctors</a>
            </div>
            <h3>{{ stats.doctors }}</h3>
        </div>
    </div>
</div>

<!-- Patients Card -->
<div class="col-md-4">
    <div class="patients-card mb-3">
        <div class="card-body d-flex justify-content-between align-items-center">
            <div>
                <h5 class="card-title">Patients</h5>
                <p class="card-text">Manage Patients</p>
                <a href="{{ url_for('admin_patients') }}" class="btn btn-primary">View Patients</a>
            </div>
            <h3>{{ stats.patients }}</h3>
        </div>
    </div>
</div>

<!-- Appointments Card (No Button or Extra Text) -->
<div class="col-md-4">
    <div class="appointments-card mb-3">
        <div class="card-body d-flex justify-content-between align-items-center">
            <h5 class="card-title">Appointments</h5>
            <h3>{{ stats.appointments }}</h3>
        </div>
    </div>
</div>

{% endif %}

<!-- Completed Appointments Card -->
<div class="col-md-6 mb-4">
    <div class="card text-center completed-card">
        <div class="card-body">
            <h5>Completed</h5>
            <h3>{{ stats.completed }}</h3>
        </div>
    </div>
</div>

<!-- Pending Appointments Card -->
<div class="col-md-6 mb-4">
    <div class="card text-center pending-card">
        <div class="card-body">
            <h5>Pending</h5>
            <h3>{{ stats.pending }}</h3>
        </div>
    </div>
</div>


<!-- Recent Appointments Table -->
<h4 class="mt-4">Recent Appointments</h4>
<table class="table table-striped">
    <thead>
        <tr>
            <th>ID</th>
            <th>Patient</th>
            <th>Doctor</th>
            <th>Date</th>
            <th>Time</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        {% for appt in recent_appointments %}
        <tr>
            <td>{{ appt.id }}</td>
            <td>{{ appt.patient.name }}</td>
            <td>{{ appt.doctor.name }}</td>
            <td>{{ appt.date.strftime("%Y-%m-%d") }}</td>
            <td>{{ appt.time.strftime("%H:%M") }}</td>
            <td>{{ appt.status }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Chart for Appointment Stats -->
<div class="chart-wrapper mt-4">
    <canvas id="appointmentChart"></canvas>
</div>

<!-- Stats Data for JavaScript -->
<script type="application/json" id="stats-data">
  {
    "completed": {{ stats.completed|default(0) }},
    "pending": {{ stats.pending|default(0) }}
  }
</script>

{% endblock %}



